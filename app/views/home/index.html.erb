<div class="megamenu">
  <div class="row groupings toggled">
    <div class="col-md-6 menuwrap">
      <label for="show_countries">
        Country Label: <input type="checkbox" data-on-color="warning" data-off-color="default" name="show_countries" value="show_countries" data-size="small">
      </label>
      <label for="show_capitals">
       Capital Cities: <input type="checkbox" data-on-color="warning" data-off-color="default" name="show_capitals" value="show_capitals" data-size="small">
      </label>
    </div>
  </div>
</div>

<div class="row">
  <div class="infobox col-md-3 sidebar">
  </div>
  <div class="col-md-8 mapview">
    <div class="yearwrap"><span class="year"></span></div>
    <div id="world-map-gdp" style="width: 100%; height: 600px;">
        <div class="wrap"></div>
    </div>
  </div>
</div>
<div class="row sliderwrap">
  <div id="slider"></div>
</div>
<script>
grouping = <%= @grouping.to_json.html_safe %>;
data = <%= @data.to_json.html_safe %>;
key_dates = <%= @key_dates.to_json.html_safe %>;
grouping = [{"code":"eu","name":"European Union","num_countries":"28","definition":"Group of countries that have come together to collaborate politically and economically.  Is organised through institutions and agreements.","":"","url":"http://europa.eu/index_en.htm","wiki_url":"http://en.wikipedia.org/wiki/European_Union","established":"1992","color":"#198AB1"},{"code":"coe","name":"Council of Europe","num_countries":"47","definition":"Organization of countries that have signed the European Convention on Human Rights to protect human rights, democracy and the rule of law.","":"","url":"http://hub.coe.int/","wiki_url":"http://en.wikipedia.org/wiki/Council_of_Europe","established":"1949","color":"#0FADB1"},{"code":"eurozone","name":"Eurozone","num_countries":"18","definition":"EU member states that have adopted the euro (€) as their common currency.","":"","url":"http://www.ecb.europa.eu/home/html/index.en.html","wiki_url":"","established":"2002","color":"#0EB562"},{"code":"eucu","name":"EU Customs Union","num_countries":"32","definition":"EU member states and four others that have agreed on the free movement of good across their boarders.  Jointly negotiate on trade with other organizations in the world.","":"","url":"","wiki_url":"http://en.wikipedia.org/wiki/European_Union_Customs_Union","established":"1958","color":"#FBD842"},{"code":"schengen","name":"SchengenArea","num_countries":"26","definition":"Countries that have agreed to let people move freely across their boarders, without the need of passport controls.","":"","url":"","wiki_url":"http://en.wikipedia.org/wiki/Schengen_Area","established":"1995","color":"#F7A52C"},{"code":"efta","name":"EFTA","num_countries":"4","definition":"Organization of countries to collabote with the EU in trade.","":"","url":"http://www.efta.int/","wiki_url":"http://en.wikipedia.org/wiki/European_Free_Trade_Association","established":"1960","color":"#F07523"}];
data = [{"name":"Austria","gis":"AUT","capital":"Vienna","capital_x":"48.2","capital_y":"16.366667","population":"8.3 million","landmass":"83870","gdp":0,"currency":"€, EUR","eu_at":1995,"coe_at":1956,"eurozone_at":1999,"eucu":"1","schengen_at":1995,"efta_at":"1960-1995"},{"name":"Belgium","gis":"BEL","capital":"Brussels","capital_x":"50.8333","capital_y":"4.33333","population":"10.7 milion","landmass":"30528","gdp":0,"currency":"€, EUR","eu_at":1952,"coe_at":1949,"eurozone_at":1999,"eucu":"1","schengen_at":1985,"efta_at":""},{"name":"Bulgaria","gis":"BGR","capital":"Sofia","capital_x":"42.6833","capital_y":"23.316667","population":"7.6 million","landmass":"111990","gdp":0,"currency":"lev (лв), BGN","eu_at":2007,"coe_at":1992,"eurozone_at":0,"eucu":"1","schengen_at":0,"efta_at":""},{"name":"Croatia","gis":"HRV","capital":"Zagreb","capital_x":"45.8","capital_y":"16","population":"4.4 million","landmass":"56594","gdp":0,"currency":"kuna, HRK","eu_at":2013,"coe_at":0,"eurozone_at":2015,"eucu":"","schengen_at":0,"efta_at":"Y"},{"name":"Cyprus","gis":"CYP","capital":"Nicosia","capital_x":"35.166667","capital_y":"33.366667","population":"0.8 million","landmass":"9250","gdp":0,"currency":"€, EUR","eu_at":2004,"coe_at":1961,"eurozone_at":2008,"eucu":"1","schengen_at":0,"efta_at":""},{"name":"Czech Republic","gis":"CZE","capital":"Prague","capital_x":"50.08333","capital_y":"14.46667","population":"10.5 million","landmass":"78866","gdp":0,"currency":"koruna (Kč), ZCK","eu_at":2004,"coe_at":1993,"eurozone_at":0,"eucu":"1","schengen_at":2007,"efta_at":""},{"name":"Denmark","gis":"DNK","capital":"Copenhagen","capital_x":"55.66667","capital_y":"12.58333","population":"5.5 million","landmass":"43094","gdp":0,"currency":"krone (kr), DKK","eu_at":1973,"coe_at":1949,"eurozone_at":0,"eucu":"1","schengen_at":1996,"efta_at":"1960-1973"},{"name":"Estonia","gis":"EST","capital":"Tallin","capital_x":"0","capital_y":"0","population":"1.3 million","landmass":"45000","gdp":0,"currency":"€, EUR","eu_at":2004,"coe_at":1993,"eurozone_at":2011,"eucu":"1","schengen_at":2007,"efta_at":""},{"name":"Finland","gis":"FIN","capital":"Helsinki","capital_x":"0","capital_y":"0","population":"5.3 million","landmass":"338000","gdp":0,"currency":"€, EUR","eu_at":1995,"coe_at":1989,"eurozone_at":1999,"eucu":"1","schengen_at":1996,"efta_at":"1961-1995"},{"name":"France","gis":"FRA","capital":"Paris","capital_x":"0","capital_y":"0","population":"64.3 million","landmass":"550000","gdp":0,"currency":"€, EUR","eu_at":1952,"coe_at":1949,"eurozone_at":1999,"eucu":"1","schengen_at":1985,"efta_at":""},{"name":"Germany","gis":"DEU","capital":"Berlin","capital_x":"0","capital_y":"0","population":"82 million","landmass":"356854","gdp":0,"currency":"€, EUR","eu_at":1952,"coe_at":1950,"eurozone_at":1999,"eucu":"1","schengen_at":1985,"efta_at":""},{"name":"Greece","gis":"GRC","capital":"Athens","capital_x":"0","capital_y":"0","population":"11.2 million","landmass":"131957","gdp":0,"currency":"€, EUR","eu_at":1981,"coe_at":1949,"eurozone_at":2001,"eucu":"1","schengen_at":1992,"efta_at":""},{"name":"Hungary","gis":"HUN","capital":"Budapest","capital_x":"0","capital_y":"0","population":"10 million","landmass":"93000","gdp":0,"currency":"forint (Ft), HUF","eu_at":2004,"coe_at":1990,"eurozone_at":0,"eucu":"1","schengen_at":2007,"efta_at":""},{"name":"Ireland","gis":"IRL","capital":"Dublin","capital_x":"0","capital_y":"0","population":"4.5 million","landmass":"70000","gdp":0,"currency":"€, EUR","eu_at":1973,"coe_at":1949,"eurozone_at":1999,"eucu":"1","schengen_at":0,"efta_at":""},{"name":"Italy","gis":"ITA","capital":"Rome","capital_x":"0","capital_y":"0","population":"50 million","landmass":"301263","gdp":0,"currency":"€, EUR","eu_at":1952,"coe_at":1949,"eurozone_at":1999,"eucu":"1","schengen_at":1990,"efta_at":""},{"name":"Latvia","gis":"LVA","capital":"Riga","capital_x":"0","capital_y":"0","population":"2.3 million","landmass":"65000","gdp":0,"currency":"€, EUR","eu_at":2004,"coe_at":1995,"eurozone_at":2013,"eucu":"1","schengen_at":2007,"efta_at":""},{"name":"Lithuania","gis":"LTU","capital":"Vinius","capital_x":"0","capital_y":"0","population":"3.3 million","landmass":"65000","gdp":0,"currency":"litas (Lt), LTL","eu_at":2004,"coe_at":1993,"eurozone_at":0,"eucu":"1","schengen_at":2007,"efta_at":""},{"name":"Luxembourg","gis":"LUX","capital":"Luxembourg","capital_x":"0","capital_y":"0","population":"0.5 million","landmass":"2586","gdp":0,"currency":"€, EUR","eu_at":1952,"coe_at":1949,"eurozone_at":1999,"eucu":"1","schengen_at":1985,"efta_at":""},{"name":"Malta","gis":"MLT","capital":"Valletta","capital_x":"0","capital_y":"0","population":"0.4 million","landmass":"316","gdp":0,"currency":"€, EUR","eu_at":2004,"coe_at":1965,"eurozone_at":2008,"eucu":"1","schengen_at":2007,"efta_at":""},{"name":"Netherlands","gis":"NLD","capital":"Amsterdam","capital_x":"0","capital_y":"0","population":"16.4 million","landmass":"41526","gdp":0,"currency":"€, EUR","eu_at":1952,"coe_at":1949,"eurozone_at":1999,"eucu":"1","schengen_at":1985,"efta_at":""},{"name":"Poland","gis":"POL","capital":"Warsaw","capital_x":"0","capital_y":"0","population":"38.1 million","landmass":"312679","gdp":0,"currency":"Zloty (zł)","eu_at":2004,"coe_at":1991,"eurozone_at":0,"eucu":"1","schengen_at":2007,"efta_at":""},{"name":"Portugal","gis":"PRT","capital":"Lisbon","capital_x":"0","capital_y":"0","population":"10.6 million","landmass":"92072","gdp":0,"currency":"€, EUR","eu_at":1986,"coe_at":1976,"eurozone_at":1999,"eucu":"1","schengen_at":1991,"efta_at":"1960-1986"},{"name":"Romania","gis":"ROU","capital":"Bucharest","capital_x":"0","capital_y":"0","population":"21.5 million","landmass":"237500","gdp":0,"currency":"leu, RON","eu_at":2007,"coe_at":1993,"eurozone_at":0,"eucu":"1","schengen_at":0,"efta_at":""},{"name":"Slovakia","gis":"SVK","capital":"Bratislava","capital_x":"0","capital_y":"0","population":"5.4 million","landmass":"48845","gdp":0,"currency":"€, EUR","eu_at":2004,"coe_at":1993,"eurozone_at":2009,"eucu":"1","schengen_at":2007,"efta_at":""},{"name":"Slovenia","gis":"SVN","capital":"Ljubljana","capital_x":"0","capital_y":"0","population":"2 million","landmass":"20273","gdp":0,"currency":"€, EUR","eu_at":2004,"coe_at":1993,"eurozone_at":2007,"eucu":"1","schengen_at":2007,"efta_at":""},{"name":"Spain","gis":"ESP","capital":"Madrid","capital_x":"0","capital_y":"0","population":"45.8 million","landmass":"504782","gdp":0,"currency":"€, EUR","eu_at":1986,"coe_at":1977,"eurozone_at":1999,"eucu":"1","schengen_at":1991,"efta_at":""},{"name":"Sweden","gis":"SWE","capital":"Stockholm","capital_x":"0","capital_y":"0","population":"9.2 million","landmass":"449964","gdp":0,"currency":"krona (kr), SEK","eu_at":1995,"coe_at":1949,"eurozone_at":0,"eucu":"1","schengen_at":1996,"efta_at":"1960-1995"},{"name":"United Kingdom","gis":"GBR","capital":"London","capital_x":"0","capital_y":"0","population":"61.7 million","landmass":"244820","gdp":0,"currency":"pound sterling (£), GBP","eu_at":1973,"coe_at":1949,"eurozone_at":0,"eucu":"1","schengen_at":0,"efta_at":"1960-1973"},{"name":"Andorra","gis":"AND","capital":"Andorra la Vella","capital_x":"0","capital_y":"0","population":"","landmass":"","gdp":0,"currency":"","eu_at":0,"coe_at":0,"eurozone_at":0,"eucu":"1","schengen_at":0,"efta_at":""},{"name":"Monaco","gis":"MCO","capital":"Monaco","capital_x":"0","capital_y":"0","population":"","landmass":"","gdp":0,"currency":"","eu_at":0,"coe_at":0,"eurozone_at":0,"eucu":"1","schengen_at":0,"efta_at":""},{"name":"San Marino","gis":"SMR","capital":"Sam Marino","capital_x":"0","capital_y":"0","population":"","landmass":"","gdp":0,"currency":"","eu_at":0,"coe_at":0,"eurozone_at":0,"eucu":"1","schengen_at":0,"efta_at":""},{"name":"Turkey","gis":"TUR","capital":"Istanbul","capital_x":"0","capital_y":"0","population":"","landmass":"","gdp":0,"currency":"","eu_at":0,"coe_at":0,"eurozone_at":0,"eucu":"1","schengen_at":0,"efta_at":""},{"name":"Liechtenstein","gis":"LIE","capital":"Vaduz","capital_x":"0","capital_y":"0","population":"","landmass":"","gdp":0,"currency":"","eu_at":0,"coe_at":0,"eurozone_at":0,"eucu":"","schengen_at":2008,"efta_at":"1991"},{"name":"Norway","gis":"NOR","capital":"Oslo","capital_x":"0","capital_y":"0","population":"","landmass":"","gdp":0,"currency":"","eu_at":0,"coe_at":0,"eurozone_at":0,"eucu":"1","schengen_at":1996,"efta_at":"1960"},{"name":"Iceland","gis":"ISL","capital":"Rekjavik","capital_x":"0","capital_y":"0","population":"","landmass":"","gdp":0,"currency":"","eu_at":0,"coe_at":0,"eurozone_at":0,"eucu":"1","schengen_at":1996,"efta_at":"1970"},{"name":"Switzerland","gis":"CHE","capital":"Bern","capital_x":"0","capital_y":"0","population":"","landmass":"","gdp":0,"currency":"","eu_at":0,"coe_at":0,"eurozone_at":0,"eucu":"","schengen_at":2004,"efta_at":"1960"}];
key_dates = [{"year":"2004","description":"EU enlarges to 25 member states"},{"year":"2002","description":"Euro replaces twelve national currencies"},{"year":"1995","description":"Schengen area established"},{"year":"1992","description":"Maastricht Treaty, The European Union is born"},{"year":"1989","description":"Fall of the Berlin wall/Iron curtain in Eastern Europe"},{"year":"1960","description":"European Free Trade Association established"},{"year":"1958","description":"European Union Customs Union established"},{"year":"1957","description":"Treaty of Rome creates Economic Community"},{"year":"1951","description":"Treaty of Paris creates Coal and Steel Community"},{"year":"1949","description":"Council of Europe established"},{"year":"1945","description":"End of the second World War"}];
var countries = new CountryList(data);
$(function(){
  load_color_map();
  load_megamenu();
  year = 2014;
  load_checkboxes();
  load_slider(year);
  load_key_dates();
  load_grouping(grouping);
  $( window ).resize(setMapScale);
  $(window).resize(function() {
    $(".sliderwrap").html('<div id="slider"></div>');
    reload(window.year);
    load_slider(window.year);
    load_key_dates();
  });
});
</script>
